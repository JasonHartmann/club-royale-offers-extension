/* General UI elements, buttons, breadcrumbs, filters, animations extracted from styles.css */
/* Whats New pulse */
@keyframes goboPulse { 0% { transform:scale(1); } 50% { transform:scale(1.08); } 100% { transform:scale(1); } }
.gobo-whatsnew-focus { animation:goboFocusGlow 1.5s infinite; }
@keyframes goboFocusGlow { 0% { box-shadow:0 0 0 4px rgba(251,191,36,.35),0 0 18px 6px rgba(251,191,36,.5);} 50% { box-shadow:0 0 0 2px rgba(251,191,36,.25),0 0 8px 3px rgba(251,191,36,.35);} 100% { box-shadow:0 0 0 4px rgba(251,191,36,.35),0 0 18px 6px rgba(251,191,36,.5);} }
.gobo-whatsnew-tooltip { animation:fadeInScale .25s ease; }
@keyframes fadeInScale { 0% { opacity:0; transform:translateY(6px) scale(.96);} 100% { opacity:1; transform:translateY(0) scale(1);} }
.close-button { background:#dc2626; }
.close-button:hover { background:#b91c1c; }
.buy-coffee-link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    margin-right: 6px;
    background: transparent;
    color: inherit;
    text-decoration: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    font-size: 13px;
    transition: background .15s, transform .08s;
}
.buy-coffee-link:hover { background: rgba(0,0,0,0.04); transform: translateY(-1px); }
.buy-coffee-link:focus { outline: 2px solid #ffd166; outline-offset: 2px; }
.coffee-emoji { font-size: 18px; line-height: 1; display:inline-block; }

/* Consolidated action button styles: keep padding, font, spacings and sizing consistent
   across primary footer/action buttons while allowing each to keep its own color. */
.action-btn, .close-button, .export-csv-button, .whatsnew-btn, .donate-button {
    color: #fff;
    font-weight: 600;
    /* horizontal padding only; use fixed height to ensure exact match */
    padding: 0 12px;
    border-radius: 0.5rem;
    cursor: pointer;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 36px;
    line-height: 1;
    font-family: inherit;
    font-size: 13px; /* normalize to a consistent button size */
    box-sizing: border-box;
    border: none; /* ensure no default border increases height */
}
.export-csv-button { background:#22c55e; transition:background .2s; }
.export-csv-button:hover { background:#16a34a; }

.whatsnew-btn { background:#6922c5; transition:background .2s; }
.whatsnew-btn:hover { background:#845bba; }

/* Donate button + panel (color-only; sizing/typography come from consolidated action rule) */
.donate-button {
    background: #f59e0b; /* amber */
}
.donate-button:hover { background: #d97706; }
.donate-button:focus { outline: 3px solid rgba(245,158,11,0.25); outline-offset: 2px; }
.donate-button::after { content: ' ▾'; margin-left: 6px; display: inline-block; transition: transform .12s; }
/* Flip chevron when donate panel is open (aria-expanded on the button) */
.donate-button[aria-expanded="true"]::after { content: ' ▴'; transform: translateY(-1px); }

/* Base donate panel defaults (hidden by default; modal.js will show it when opened) */
.donate-panel { display: none; position: absolute; z-index: 2147483650; }

body.gobo-dark .donate-panel {
    --gobo-donate-panel-bg: #0f172a;
    --gobo-donate-panel-border: rgba(148,163,184,0.25);
    --gobo-donate-panel-shadow: 0 8px 20px rgba(0,0,0,0.55);
    --gobo-donate-panel-sep: rgba(148,163,184,0.25);
}

.donate-panel a.buy-coffee-link, .donate-panel a.venmo-link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    text-decoration: none;
    color: #111827;
    border-radius: 6px;
}
.donate-panel a.buy-coffee-link { justify-content: center; }
/* Keep venmo label + icon centered inside the panel for consistent visuals */
.donate-panel a.venmo-link { justify-content: center; }
.donate-panel a.venmo-link img { margin-right: 8px; }
.donate-panel a.buy-coffee-link:hover, .donate-panel a.venmo-link:hover { background: rgba(0,0,0,0.03); }
.donate-panel .buy-coffee-text { display: inline-block; }

body.gobo-dark .donate-panel a.buy-coffee-link,
body.gobo-dark .donate-panel a.venmo-link {
    color:#e2e8f0;
}
body.gobo-dark .donate-panel a.buy-coffee-link:hover,
body.gobo-dark .donate-panel a.venmo-link:hover {
    background: rgba(148,163,184,0.2);
}

/* Ensure donate-panel is not cut off in small viewports */
.donate-panel { max-width: 80vw; }

/* Ensure the donate panel's column content is centered horizontally so
    links like the Venmo entry appear centered on narrow/mobile viewports
    (fixes iOS layout where the link could appear flush-left). */
.donate-panel > div { display: flex; flex-direction: column; gap: 8px; align-items: center; }
.donate-panel .donate-panel-link { justify-content: center; width: auto; }
/* Back-to-Back (B2B) search button styling — moved from inline in tableRenderer.js */
.b2b-search-button { margin-left:12px; background:#0d3b66; color:#fff; border:none; padding:4px 10px; font-size:11px; border-radius:4px; cursor:pointer; font-weight:600; transition:background .15s, transform .08s; }
.b2b-search-button:hover { background:#0b3557; transform:translateY(-1px); }
.b2b-side-by-side-toggle { margin-left:12px; display:inline-flex; align-items:center; gap:6px; font-size:11px; font-weight:600; cursor:pointer; user-select:none; }
.b2b-side-by-side-toggle input { cursor:pointer; accent-color:#0d3b66; }
.b2b-chevrons { display:inline-flex; align-items:center; justify-content:center; gap:4px; padding:4px 10px; border-radius:999px; background:linear-gradient(90deg,#0c4ea3 0%,#1f7edc 100%); color:#fff; font-weight:600; font-size:11px; line-height:1; box-shadow:0 3px 8px rgba(8,52,99,0.25); min-width:46px; position:relative; }
.b2b-chevrons::after { content:'>>'; font-weight:700; letter-spacing:0.5px; font-size:10px; opacity:0.9; }
.b2b-chevrons-value { font-size:12px; letter-spacing:0.03em; font-variant-numeric:tabular-nums; }
.b2b-depth-cell-action:focus-visible { outline:2px solid rgba(12,78,163,0.8); outline-offset:1px; border-radius:999px; }
.b2b-pill-button { border:none; cursor:pointer; transition:transform .15s, box-shadow .15s; }
.b2b-pill-button:focus-visible { outline:2px solid rgba(255,255,255,0.85); outline-offset:2px; }
.b2b-pill-button:hover { transform:translateY(-1px); box-shadow:0 6px 14px rgba(9,45,92,0.35); }
/* Ensure pill areas show interactive cursor across table and accordion views */
.b2b-depth-cell-action, .b2b-depth-cell-action .b2b-chevrons, .b2b-chevrons { cursor: pointer; }
.b2b-depth-cell-action:hover .b2b-chevrons, .b2b-chevrons:hover { transform: translateY(-2px); box-shadow: 0 8px 18px rgba(9,45,92,0.28); }
/* Ensure the inner chevrons show interactive cues only when the cell is actually bound */
.b2b-depth-cell-action[data-b2b-cell-bound="true"] { cursor: pointer; pointer-events: auto; }
.b2b-depth-cell-action[data-b2b-cell-bound="true"] .b2b-chevrons,
.b2b-depth-cell-action[data-b2b-cell-bound="true"] > .b2b-chevrons { cursor: pointer; }
.b2b-depth-cell-action[data-b2b-cell-bound="true"] .b2b-chevrons:hover,
.b2b-depth-cell-action[data-b2b-cell-bound="true"] > .b2b-chevrons:hover { transform: translateY(-2px); box-shadow: 0 8px 18px rgba(9,45,92,0.28); }

.b2b-visualizer-overlay { position:fixed; inset:0; background:rgba(5,13,32,0.65); z-index:2147483651; display:flex; align-items:flex-start; justify-content:center; padding:24px; overflow-y:auto; -webkit-overflow-scrolling:touch; backdrop-filter:blur(2px); overscroll-behavior:contain; touch-action:pan-y; }
.b2b-visualizer-modal {
    width: min(1100px, 95vw);
    /* Cap the modal to the viewport minus a small chrome margin so it never grows past the screen */
    max-height: calc(100vh - 48px);
    /* Open at the largest practical height so it does not grow as the chain fills */
    min-height: min(860px, calc(100vh - 48px));
    background: #f7f9fc;
    border-radius: 22px;
    box-shadow: 0 30px 60px rgba(0,0,0,0.45);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.2);
    box-sizing: border-box;
}
.b2b-visualizer-header { padding:20px 28px; background:linear-gradient(120deg,#0c4ea3,#1f7edc); color:#fff; display:flex; justify-content:space-between; align-items:flex-start; gap:12px; }
.b2b-visualizer-title { font-size:20px; font-weight:700; margin:0; }
.b2b-visualizer-subtitle { font-size:13px; opacity:0.9; margin-top:4px; max-width:540px; }
.b2b-visualizer-close { border:none; background:rgba(255,255,255,0.15); color:#fff; width:32px; height:32px; border-radius:8px; font-size:18px; font-weight:600; cursor:pointer; transition:background .15s, transform .1s; }
.b2b-visualizer-close:hover { background:rgba(255,255,255,0.3); transform:translateY(-1px); }
.b2b-visualizer-body {
    padding: 24px 28px;
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 24px;
    overflow: auto;
    flex: 1 1 auto;
    min-height: 0;
    /* Ensure the body fits inside the viewport and scrolls internally.
       Use viewport-relative units instead of percentage to avoid circular
       sizing dependency on the modal's content height. Subtract estimated
       header + actions chrome to leave room for them. */
    max-height: calc(100vh - 160px);
}

/* Safari workaround: when scrollbars overlay content (do not reserve layout),
     the selected sailings column can be obscured. Prefer using scrollbar-gutter
     where supported, otherwise apply a fallback right padding when the overlay
     has the detection class added by the JS. */
.b2b-visualizer-overlay {
    /* Prefer modern API to reserve space for overlay scrollbars */
    scrollbar-gutter: auto;
    /* Declare custom property so static analysis tools can resolve it;
       the actual value is set by JS (_applyScrollbarFallback). */
    --b2b-scrollbar-gap: 0px;
}

/* Fallback: when scrollbar-gutter isn't supported (older Safari), the JS will
     add `.b2b-scrollbar-overlap` to any scrollable column/list. Apply padding so
     the selected cards are not covered by the scrollbar. */
.b2b-visualizer-overlay.b2b-scrollbar-overlap .b2b-chain-column {
    /* Use measured scrollbar gap from JS; fallback to 20px */
    padding-right: var(--b2b-scrollbar-gap, 20px);
}

.b2b-chain-cards.b2b-scrollbar-overlap {
    padding-right: var(--b2b-scrollbar-gap, 14px);
}

/* Slightly increase the chain cards' right-side inset so controls stay visible */
.b2b-chain-cards.b2b-scrollbar-overlap .b2b-chain-card {
    margin-right: 4px;
}

.b2b-option-list.b2b-scrollbar-overlap {
    padding-right: calc(11px + var(--b2b-scrollbar-gap, 8px));
}
.b2b-chain-column, .b2b-option-column {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 0;
}
/* Make the cards container a column flexbox that scrolls vertically. This
   ensures cards keep their natural height and the list scrolls instead of
   compressing items on all form factors. */
.b2b-chain-cards, .b2b-option-list {
    display: flex;
    flex-direction: column;
    gap: 14px;
    flex: 1 1 auto;
    min-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
    /* let scrollbars reserve their own space without clipping card edges */
    padding-right: 0;
    scrollbar-gutter: auto;
    overscroll-behavior: contain;
    touch-action: pan-y;
}

.b2b-section-title { font-size:15px; font-weight:700; color:#0f172a; display:flex; align-items:center; gap:8px; margin:0; }
.b2b-section-title small { font-size:11px; font-weight:500; color:#64748b; text-transform:uppercase; letter-spacing:0.06em; }
.b2b-chain-card { border-radius:18px; background:#fff; padding:12px; box-shadow:0 10px 24px rgba(15,23,42,0.12); border:1px solid rgba(15,23,42,0.08); position:relative; display:flex; flex-direction:column; gap:6px; /* prevent the card from forcing horizontal growth */ max-width: 100%; overflow-x: hidden; word-break: break-word; flex: 0 0 auto; }
.b2b-chain-card, .b2b-option-card { z-index: 0; }
.b2b-chain-card.is-root { background:linear-gradient(135deg,#dbeafe,#eff6ff); border-color:rgba(59,130,246,0.3); box-shadow:0 0 0 2px rgba(59,130,246,0.15), 0 10px 24px rgba(59,130,246,0.2); }
.b2b-chain-card.b2b-chain-same-ship { background:linear-gradient(135deg,#dcfce7,#f0fdf4); border-color:rgba(34,197,94,0.4); box-shadow:0 0 0 2px rgba(34,197,94,0.15), 0 10px 24px rgba(34,197,94,0.2); }
.b2b-chain-card.b2b-chain-side-by-side { background:linear-gradient(135deg,#fef3c7,#fef9e7); border-color:rgba(217,119,6,0.4); box-shadow:0 0 0 2px rgba(217,119,6,0.15), 0 10px 24px rgba(217,119,6,0.2); }
.b2b-chain-card.b2b-chain-region-link { background:linear-gradient(135deg,#f3e8ff,#faf5ff); border-color:rgba(139,92,246,0.45); box-shadow:0 0 0 2px rgba(139,92,246,0.15), 0 10px 24px rgba(139,92,246,0.22); }
.b2b-chain-card.is-root .b2b-chain-step-head h4,
.b2b-chain-card.is-root .b2b-chain-meta,
.b2b-chain-card.is-root .b2b-chain-meta strong { color:#1e3a8a; }
.b2b-chain-card.is-root .b2b-chain-step-head span,
.b2b-chain-card.is-root .b2b-chain-ports { color:#1e40af; border-left-color:rgba(30,64,175,0.25); }
.b2b-chain-card.b2b-chain-same-ship .b2b-chain-step-head h4,
.b2b-chain-card.b2b-chain-same-ship .b2b-chain-meta,
.b2b-chain-card.b2b-chain-same-ship .b2b-chain-meta strong { color:#065f46; }
.b2b-chain-card.b2b-chain-same-ship .b2b-chain-step-head span,
.b2b-chain-card.b2b-chain-same-ship .b2b-chain-ports { color:#047857; border-left-color:rgba(4,120,87,0.25); }
.b2b-chain-card.b2b-chain-side-by-side .b2b-chain-step-head h4,
.b2b-chain-card.b2b-chain-side-by-side .b2b-chain-meta,
.b2b-chain-card.b2b-chain-side-by-side .b2b-chain-meta strong { color:#78350f; }
.b2b-chain-card.b2b-chain-side-by-side .b2b-chain-step-head span,
.b2b-chain-card.b2b-chain-side-by-side .b2b-chain-ports { color:#92400e; border-left-color:rgba(146,64,14,0.25); }
.b2b-chain-card.b2b-chain-region-link .b2b-chain-step-head h4,
.b2b-chain-card.b2b-chain-region-link .b2b-chain-meta,
.b2b-chain-card.b2b-chain-region-link .b2b-chain-meta strong { color:#581c87; }
.b2b-chain-card.b2b-chain-region-link .b2b-chain-step-head span,
.b2b-chain-card.b2b-chain-region-link .b2b-chain-ports { color:#6b21a8; border-left-color:rgba(107,33,168,0.25); }
.b2b-chain-step-head { display:flex; justify-content:space-between; gap:8px; align-items:flex-start; }
.b2b-chain-step-head h4 { margin:0; font-size:15px; color:#0f172a; }
.b2b-chain-step-head span { font-size:11px; font-weight:600; color:#475569; text-transform:uppercase; letter-spacing:0.04em; display:inline-block; padding-right:28px; box-sizing:border-box; }
.b2b-chain-meta { font-size:13px; color:#1e293b; display:flex; flex-direction:column; gap:4px; }
.b2b-chain-meta strong { font-size:12px; color:#0f172a; }
.b2b-chain-ports { font-size:12px; color:#475569; line-height:1.4; border-left:3px solid rgba(15,23,42,0.15); padding-left:10px; margin-top:6px; }
.b2b-chain-card .b2b-timeline-table {
    /* Make the timeline table fluid and prevent it from expanding past the card.
       Use fixed table layout so cells wrap predictably and avoid horizontal growth. */
    width: 100%;
    border-collapse: collapse;
    box-sizing: border-box;
    font-size: 13px;
    display: table;
    table-layout: fixed; /* allow cells to respect width and wrap */
    max-height: none;
    overflow-x: hidden;
    white-space: normal; /* allow label wrapping */
}
.b2b-chain-card .b2b-timeline-table tbody {
    display: table-row-group;
    max-height: none;
    overflow: visible;
}
.b2b-chain-card .b2b-timeline-table tr {
    display: table-row;
    width: 100%;
}

/* Color legend */
.b2b-color-legend { display:flex; flex-wrap:wrap; gap:10px 16px; padding:6px 16px 8px; font-size:12px; color:#475569; border-bottom:1px solid rgba(15,23,42,0.08); }
.b2b-legend-item { display:inline-flex; align-items:center; gap:5px; }
.b2b-legend-dot { width:12px; height:12px; border-radius:4px; flex-shrink:0; }
.b2b-legend-dot.is-root { background:linear-gradient(135deg,#dbeafe,#93c5fd); border:1px solid rgba(59,130,246,0.4); }
.b2b-legend-dot.b2b-chain-same-ship { background:linear-gradient(135deg,#dcfce7,#86efac); border:1px solid rgba(34,197,94,0.5); }
.b2b-legend-dot.b2b-chain-side-by-side { background:linear-gradient(135deg,#fef3c7,#fcd34d); border:1px solid rgba(217,119,6,0.5); }
.b2b-legend-dot.b2b-chain-region-link { background:linear-gradient(135deg,#f3e8ff,#c4b5fd); border:1px solid rgba(139,92,246,0.5); }

/* Dark mode overrides */
body.gobo-dark .b2b-color-legend { color:#94a3b8; border-bottom-color:rgba(148,163,184,0.15); }
body.gobo-dark .b2b-legend-dot.is-root { background:linear-gradient(135deg,#1e3a8a,#2563eb); border-color:rgba(96,165,250,0.5); }
body.gobo-dark .b2b-legend-dot.b2b-chain-same-ship { background:linear-gradient(135deg,#064e3b,#059669); border-color:rgba(34,197,94,0.5); }
body.gobo-dark .b2b-legend-dot.b2b-chain-side-by-side { background:linear-gradient(135deg,#78350f,#d97706); border-color:rgba(245,158,11,0.5); }
body.gobo-dark .b2b-legend-dot.b2b-chain-region-link { background:linear-gradient(135deg,#581c87,#8b5cf6); border-color:rgba(167,139,250,0.5); }

body.gobo-dark .b2b-visualizer-modal {
    background:#0f172a;
    color:#e2e8f0;
    border:1px solid rgba(148,163,184,0.2);
    box-shadow:0 30px 60px rgba(0,0,0,0.6);
}
body.gobo-dark .b2b-visualizer-header {
    background:linear-gradient(120deg,#111827,#1f2937);
    color:#e2e8f0;
}
body.gobo-dark .b2b-visualizer-close { background:rgba(148,163,184,0.2); color:#e2e8f0; }
body.gobo-dark .b2b-visualizer-close:hover { background:rgba(148,163,184,0.35); }
body.gobo-dark .b2b-section-title { color:#e2e8f0; }
body.gobo-dark .b2b-section-title small { color:#94a3b8; }
body.gobo-dark .b2b-chain-card { background:#111827; border:1px solid rgba(148,163,184,0.2); box-shadow:0 10px 24px rgba(0,0,0,0.45); }
body.gobo-dark .b2b-chain-card.is-root { background:linear-gradient(135deg,#1e3a8a,#1e40af); border-color:rgba(96,165,250,0.4); box-shadow:0 0 0 2px rgba(96,165,250,0.2), 0 10px 24px rgba(59,130,246,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship { background:linear-gradient(135deg,#064e3b,#065f46); border-color:rgba(34,197,94,0.5); box-shadow:0 0 0 2px rgba(34,197,94,0.2), 0 10px 24px rgba(34,197,94,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side { background:linear-gradient(135deg,#78350f,#92400e); border-color:rgba(245,158,11,0.5); box-shadow:0 0 0 2px rgba(245,158,11,0.2), 0 10px 24px rgba(245,158,11,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link { background:linear-gradient(135deg,#581c87,#6b21a8); border-color:rgba(167,139,250,0.55); box-shadow:0 0 0 2px rgba(167,139,250,0.2), 0 10px 24px rgba(167,139,250,0.3); }
body.gobo-dark .b2b-chain-card.is-root .b2b-chain-step-head h4,
body.gobo-dark .b2b-chain-card.is-root .b2b-chain-meta,
body.gobo-dark .b2b-chain-card.is-root .b2b-chain-meta strong { color:#e0f2fe; }
body.gobo-dark .b2b-chain-card.is-root .b2b-chain-step-head span,
body.gobo-dark .b2b-chain-card.is-root .b2b-chain-ports { color:#bfdbfe; border-left-color:rgba(191,219,254,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-chain-step-head h4,
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-chain-meta,
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-chain-meta strong { color:#d1fae5; }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-chain-step-head span,
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-chain-ports { color:#a7f3d0; border-left-color:rgba(167,243,208,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-chain-step-head h4,
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-chain-meta,
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-chain-meta strong { color:#fef3c7; }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-chain-step-head span,
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-chain-ports { color:#fde68a; border-left-color:rgba(253,230,138,0.3); }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-chain-step-head h4,
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-chain-meta,
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-chain-meta strong { color:#f3e8ff; }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-chain-step-head span,
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-chain-ports { color:#e9d5ff; border-left-color:rgba(233,213,255,0.3); }
body.gobo-dark .b2b-chain-step-head h4,
body.gobo-dark .b2b-chain-meta { color:#e2e8f0; }
body.gobo-dark .b2b-chain-step-head span,
body.gobo-dark .b2b-chain-ports { color:#cbd5f5; border-left-color:rgba(148,163,184,0.3); }
body.gobo-dark .b2b-chain-meta strong { color:#f8fafc; }
body.gobo-dark .b2b-chain-meta span { color:#e2e8f0; }
body.gobo-dark .b2b-option-card { background:#111827; border:1px solid rgba(148,163,184,0.2); }
body.gobo-dark .b2b-option-card h4,
body.gobo-dark .b2b-option-card p { color:#e2e8f0; }
body.gobo-dark .b2b-banner { background:#0b1220; color:#e2e8f0; border-top:1px solid rgba(148,163,184,0.2); }
body.gobo-dark .b2b-action-btn.secondary { background:#1f2937; color:#e2e8f0; border:1px solid rgba(148,163,184,0.2); }
body.gobo-dark .b2b-action-btn.secondary:hover { background:#243046; }
body.gobo-dark .b2b-action-btn.primary { background:#2563eb; color:#fff; }
body.gobo-dark .b2b-action-btn.primary:hover { background:#1d4ed8; }
body.gobo-dark .gobo-setting-area .gobo-setting-desc,
body.gobo-dark .b2b-visualizer-subtitle { color:#cbd5f5; }
body.gobo-dark .b2b-actions { background:#0b1220; border-top:1px solid rgba(148,163,184,0.2); }
body.gobo-dark .b2b-center-hint { color:#94a3b8; }
body.gobo-dark .b2b-side-note { color:#93c5fd; }
body.gobo-dark .b2b-empty-state { border:1px dashed rgba(148,163,184,0.3); color:#94a3b8; }
body.gobo-dark .b2b-empty-state strong { color:#e2e8f0; }
body.gobo-dark .b2b-option-meta { color:#e2e8f0; }
body.gobo-dark .b2b-option-card strong { color:#e2e8f0; }
body.gobo-dark .b2b-option-card .badge { color:#bae6fd; background:rgba(59,130,246,0.18); padding:2px 8px; border-radius:999px; }
body.gobo-dark .b2b-option-card.b2b-side-by-side { border-color:rgba(245,158,11,0.55); border-width:2px; box-shadow:0 10px 24px rgba(245,158,11,0.18); }
body.gobo-dark .b2b-option-card.b2b-region-link { border-color:rgba(167,139,250,0.7); border-width:2px; box-shadow:0 10px 24px rgba(167,139,250,0.25); }
body.gobo-dark .b2b-option-card.b2b-same-ship { border-color:rgba(34,197,94,0.65); border-width:2px; box-shadow:0 10px 24px rgba(34,197,94,0.22); }
body.gobo-dark .b2b-option-card .badge.badge-region { color:#e9d5ff; background:rgba(139,92,246,0.22); }
body.gobo-dark .b2b-option-select { background:#16a34a; }
body.gobo-dark .b2b-price-chip { border-color:rgba(148,163,184,0.3); background:rgba(15,23,42,0.6); color:#e2e8f0; }
body.gobo-dark .b2b-price-chip:hover { border-color:rgba(96,165,250,0.6); box-shadow:0 8px 18px rgba(59,130,246,0.25); background:rgba(30,41,59,0.85); }
body.gobo-dark .b2b-price-chip.selected { border-color:rgba(34,197,94,0.8); border-width:2px; box-shadow:0 8px 18px rgba(34,197,94,0.25); background:rgba(34,197,94,0.12); }
body.gobo-dark .b2b-price-label { color:#94a3b8; }
body.gobo-dark .b2b-price-value { color:#e2e8f0; }
body.gobo-dark .b2b-tax-line { color:#cbd5f5; }
body.gobo-dark .b2b-option-select:hover { background:#15803d; }
body.gobo-dark .b2b-option-select .b2b-depth-pill { background:rgba(15,23,42,0.6); color:#e2e8f0; }
body.gobo-dark .b2b-depth-pill-empty { background:rgba(148,163,184,0.25); color:#94a3b8; }
body.gobo-dark .b2b-timeline { color:#cbd5f5; }
body.gobo-dark .b2b-timeline-day { color:#e2e8f0; }
body.gobo-dark .b2b-timeline-dow { color:#94a3b8; }
body.gobo-dark .b2b-timeline-label { color:#cbd5f5; }
body.gobo-dark .b2b-timeline .dot { background:#94a3b8; }
body.gobo-dark .b2b-chain-card .b2b-timeline::-webkit-scrollbar-thumb { background:rgba(148,163,184,0.35); }
body.gobo-dark .b2b-chain-card.is-root .b2b-timeline-day,
body.gobo-dark .b2b-chain-card.is-root .b2b-timeline-label { color:#e0f2fe; }
body.gobo-dark .b2b-chain-card.is-root .b2b-timeline-dow { color:#93c5fd; }
body.gobo-dark .b2b-chain-card.is-root .b2b-timeline .dot { background:#93c5fd; }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-timeline-day,
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-timeline-label { color:#d1fae5; }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-timeline-dow { color:#86efac; }
body.gobo-dark .b2b-chain-card.b2b-chain-same-ship .b2b-timeline .dot { background:#86efac; }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-day,
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-label { color:#fef3c7; }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-dow { color:#fcd34d; }
body.gobo-dark .b2b-chain-card.b2b-chain-side-by-side .b2b-timeline .dot { background:#fcd34d; }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-timeline-day,
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-timeline-label { color:#f3e8ff; }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-timeline-dow { color:#d8b4fe; }
body.gobo-dark .b2b-chain-card.b2b-chain-region-link .b2b-timeline .dot { background:#d8b4fe; }
.b2b-timeline-day {
    width: 48px;
    min-width: 40px;
    font-weight: bold;
    color: #0f172a;
    padding: 1px 6px; /* tighten horizontal spacing */
    white-space: nowrap;
    font-size: 12px;
}
.b2b-timeline-dow {
    width: 40px;
    min-width: 36px;
    color: #64748b;
    padding: 1px 6px; /* tighten horizontal spacing */
    white-space: nowrap;
    font-size: 12px;
}
.b2b-timeline-label {
    color: #475569;
    padding: 1px 6px; /* tighten spacing between columns */
    white-space: normal; /* allow wrapping instead of forcing a single long line */
    overflow-wrap: anywhere;
    word-break: break-word;
    text-overflow: ellipsis;
    font-size: 12px;
}
.b2b-chain-card.is-root .b2b-timeline-day,
.b2b-chain-card.is-root .b2b-timeline-label { color:#1e3a8a; }
.b2b-chain-card.is-root .b2b-timeline-dow { color:#3b82f6; }
.b2b-chain-card.is-root .b2b-timeline .dot { background:#3b82f6; }
.b2b-chain-card.b2b-chain-same-ship .b2b-timeline-day,
.b2b-chain-card.b2b-chain-same-ship .b2b-timeline-label { color:#065f46; }
.b2b-chain-card.b2b-chain-same-ship .b2b-timeline-dow { color:#10b981; }
.b2b-chain-card.b2b-chain-same-ship .b2b-timeline .dot { background:#10b981; }
.b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-day,
.b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-label { color:#78350f; }
.b2b-chain-card.b2b-chain-side-by-side .b2b-timeline-dow { color:#d97706; }
.b2b-chain-card.b2b-chain-side-by-side .b2b-timeline .dot { background:#d97706; }
.b2b-chain-card.b2b-chain-region-link .b2b-timeline-day,
.b2b-chain-card.b2b-chain-region-link .b2b-timeline-label { color:#581c87; }
.b2b-chain-card.b2b-chain-region-link .b2b-timeline-dow { color:#a855f7; }
.b2b-chain-card.b2b-chain-region-link .b2b-timeline .dot { background:#a855f7; }
.b2b-chain-card .b2b-timeline::-webkit-scrollbar {
    width: 8px;
}
.b2b-chain-card .b2b-timeline::-webkit-scrollbar-thumb {
    background: rgba(15,23,42,0.25);
    border-radius: 999px;
}
.b2b-chain-card .b2b-timeline::-webkit-scrollbar-track {
    background: transparent;
}
.b2b-chain-remove { position:absolute; top:12px; right:12px; border:none; background:rgba(239,68,68,0.08); color:#b91c1c; border-radius:999px; width:28px; height:28px; font-size:14px; font-weight:700; cursor:pointer; display:flex; align-items:center; justify-content:center; }
.b2b-chain-remove:hover { background:rgba(239,68,68,0.18); }
.b2b-timeline { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:6px; font-size:12px; color:#475569; }
.b2b-timeline li { display:flex; gap:6px; align-items:flex-start; /* slightly tighter gap */ }
.b2b-timeline .dot { width:6px; height:6px; border-radius:50%; background:#0f172a; margin-top:6px; flex-shrink:0; }
.b2b-option-list { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:16px; align-content: start; grid-auto-rows: auto; }
.b2b-option-card { background:#fff; border-radius:16px; border:1px solid rgba(15,23,42,0.08); padding:16px; display:flex; flex-direction:column; gap:10px; box-shadow:0 8px 18px rgba(15,23,42,0.08); position:relative; }
.b2b-option-card .b2b-option-card-header { display:flex; align-items:center; justify-content:space-between; gap:8px; }
.b2b-option-card .b2b-option-card-header .badge { margin:0; }
.b2b-option-card .b2b-option-badges { display:flex; align-items:center; gap:6px; flex-wrap:wrap; justify-content:flex-end; }
.b2b-option-card .badge { font-size:11px; text-transform:uppercase; letter-spacing:0.05em; font-weight:600; color:#0369a1; }
.b2b-option-card .badge.badge-region { color:#6d28d9; background:rgba(139,92,246,0.14); padding:2px 8px; border-radius:999px; }
.b2b-option-card.b2b-side-by-side { border-color:rgba(217,119,6,0.5); border-width:2px; box-shadow:0 10px 24px rgba(217,119,6,0.15); }
.b2b-option-card.b2b-region-link { border-color:rgba(139,92,246,0.6); border-width:2px; box-shadow:0 10px 24px rgba(139,92,246,0.22); }
.b2b-option-card.b2b-same-ship { border-color:rgba(34,197,94,0.5); border-width:2px; box-shadow:0 10px 24px rgba(34,197,94,0.18); }
.b2b-pricing { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
.b2b-pricing-grid { display:grid; grid-template-columns:repeat(2, minmax(0, 1fr)); gap:8px; }
.b2b-price-chip { display:flex; flex-direction:column; gap:2px; padding:8px 10px; border-radius:10px; border:1px solid rgba(15,23,42,0.12); background:rgba(248,250,252,0.9); color:#0f172a; font-size:11px; font-weight:600; text-align:left; }
.b2b-price-chip.is-clickable { cursor:pointer; }
.b2b-price-chip:hover { border-color:rgba(59,130,246,0.45); box-shadow:0 6px 16px rgba(59,130,246,0.18); background:rgba(226,232,240,0.95); }
.b2b-price-chip:focus-visible { outline:2px solid rgba(59,130,246,0.7); outline-offset:2px; }
.b2b-price-chip.selected { border-color:rgba(16,185,129,0.8); border-width:2px; box-shadow:0 6px 16px rgba(16,185,129,0.25); background:rgba(16,185,129,0.08); }
.b2b-price-chip.is-sold-out { background: rgba(226,232,240,0.5); border-color: rgba(148,163,184,0.5); color: #64748b; cursor: not-allowed; }
.b2b-price-chip.is-sold-out .b2b-price-value { color: #94a3b8; font-weight:600; }
.b2b-price-label { font-size:10px; text-transform:uppercase; letter-spacing:0.06em; color:#64748b; }
.b2b-price-value { font-size:13px; font-weight:700; color:#0f172a; }
.b2b-tax-line { font-size:11px; color:#475569; }
.b2b-option-meta { font-size:13px; color:#0f172a; display:flex; flex-direction:column; gap:4px; }
.b2b-option-select { margin-top:auto; border:none; border-radius:12px; padding:10px 12px; font-weight:600; font-size:13px; cursor:pointer; background:#0f9d58; color:#fff; transition:background .15s, transform .1s; user-select:none; -webkit-appearance:none; appearance:none; }

.b2b-option-select:hover { background:#0a7a43; transform:translateY(-1px); }
.b2b-option-select:focus-visible { outline:2px solid rgba(56,189,248,0.8); outline-offset:2px; }
.b2b-option-select { display:inline-flex; align-items:center; justify-content:center; gap:10px; position:relative; padding-right:36px; }
.b2b-option-select .b2b-depth-pill { position:absolute; right:8px; top:50%; transform:translateY(-50%); background:rgba(255,255,255,0.12); color:#fff; padding:4px 8px; border-radius:999px; font-size:12px; font-weight:700; display:inline-flex; align-items:center; justify-content:center; min-width:24px; }
.b2b-option-select .b2b-depth-pill svg { height:14px; width:auto; }
.b2b-depth-pill-empty { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.7); font-weight:600; }

@keyframes gobo-spin {
    to { transform: rotate(360deg); }
}

/* When there are zero additional connections, visually de-emphasize the pill
   and remove the chevrons marker. Table cells expose child-count via
   `data-child-count` on the `.b2b-depth-cell` element. */
.b2b-depth-cell[data-child-count="0"] .b2b-chevrons {
    background: linear-gradient(90deg,#f1f5f9 0%,#f8fafc 100%);
    color: #6b7280;
    box-shadow: none;
    border: 1px solid rgba(15,23,42,0.06);
    font-weight:600;
}
.b2b-depth-cell[data-child-count="0"] .b2b-chevrons::after {
    content: '';
}
.b2b-depth-cell[data-child-count="0"] .b2b-chevrons-value {
    color: #475569;
    font-weight:600;
}

/* When a row is highlighted with .gobo-b2b-selected the parent background can tint
   translucent child pills. Force the pills to keep their intended backgrounds/colors. */
.accordion-table tr.gobo-b2b-selected .b2b-chevrons,
.accordion-table td.gobo-b2b-selected .b2b-chevrons,
.gobo-b2b-selected .b2b-chevrons {
    background: linear-gradient(90deg,#0c4ea3 0%,#1f7edc 100%) !important;
    color: #fff !important;
    box-shadow: 0 3px 8px rgba(8,52,99,0.25) !important;
}

/* Exception: when child-count is zero, keep the de-emphasized grey pill even if row is selected */
.gobo-b2b-selected .b2b-depth-cell[data-child-count="0"] .b2b-chevrons,
.accordion-table tr.gobo-b2b-selected .b2b-depth-cell[data-child-count="0"] .b2b-chevrons,
.accordion-table td.gobo-b2b-selected .b2b-depth-cell[data-child-count="0"] .b2b-chevrons {
    /* Re-apply the grey/neutral background and text for empty child-count pills */
    background: linear-gradient(90deg,#f1f5f9 0%,#f8fafc 100%) !important;
    color: #6b7280 !important;
    box-shadow: none !important;
    border: 1px solid rgba(15,23,42,0.06) !important;
}

.accordion-table tr.gobo-b2b-selected .b2b-depth-pill,
.accordion-table td.gobo-b2b-selected .b2b-depth-pill,
.gobo-b2b-selected .b2b-depth-pill {
    /* Keep option pills readable (white translucent on blue backgrounds) */
    background: rgba(255,255,255,0.12) !important;
    color: #fff !important;
    box-shadow: none !important;
}

.accordion-table tr.gobo-b2b-selected .b2b-chain-id-badge,
.gobo-b2b-selected .b2b-chain-id-badge {
    background: #eef2ff !important;
    color: #3730a3 !important;
    border: 1px solid rgba(0,0,0,0.08) !important;
}
.b2b-center-hint { font-size:12px; color:#475569; display:flex; align-items:center; gap:6px; }
.b2b-banner { border-radius:12px; padding:10px 14px; background:#e2e8f0; color:#0f172a; font-size:12px; display:flex; align-items:center; gap:10px; flex-wrap: wrap; }
.b2b-banner-status { font-weight:600; flex: 1 1 auto; min-width: 0; line-height: 1.35; }
.b2b-banner-message { font-weight:500; flex: 1 1 auto; min-width: 0; }
.b2b-side-note { font-size:12px; color:#1e3a8a; }
.b2b-actions { display:flex; justify-content:space-between; gap:12px; padding:16px 28px 24px; border-top:1px solid rgba(15,23,42,0.08); background:#fff; }
.b2b-action-btn { flex:1; border:none; border-radius:999px; padding:12px 16px; font-weight:600; font-size:14px; cursor:pointer; transition:background .15s, transform .1s; }
.b2b-action-btn.primary { background:#0c4ea3; color:#fff; }
.b2b-action-btn.primary:hover:not(:disabled) { background:#0a4289; transform:translateY(-1px); }
.b2b-action-btn.secondary { background:#e2e8f0; color:#0f172a; }
.b2b-action-btn.secondary:hover { background:#cbd5f5; }
.b2b-action-btn:disabled { opacity:0.5; cursor:not-allowed; transform:none; }
.b2b-empty-state { border:1px dashed rgba(15,23,42,0.2); border-radius:16px; padding:32px; text-align:center; font-size:14px; color:#475569; }
.b2b-empty-state strong { display:block; font-size:16px; margin-bottom:6px; color:#0f172a; }

/* Main responsive breakpoint: stack panels vertically on narrow screens */
@media (max-width: 960px) {
    /* Maximize modal size on narrow screens */
    .b2b-visualizer-overlay {
        padding: 16px;
    }

    .b2b-visualizer-modal {
        width: 100%;
        max-width: 100vw;
        max-height: calc(100vh - 32px);
        min-height: calc(100vh - 32px);
        border-radius: 16px;
    }

    .b2b-visualizer-header {
        padding: 16px 20px;
    }

    /* Stack Selected Sailings above Next Connections */
    .b2b-visualizer-body {
        grid-template-columns: 1fr;
        max-height: none;
        padding: 16px 20px;
        gap: 20px;
        flex: 1 1 auto;
        min-height: 0;
    }

    /* Next Connections: single column on narrow screens */
    .b2b-option-list {
        grid-template-columns: 1fr;
        gap: 12px;
    }

    /* Adjust spacing */
    .b2b-chain-column, .b2b-option-column { gap: 12px; }
    .b2b-chain-cards { gap: 12px; }

    /* Stack action buttons vertically */
    .b2b-actions {
        flex-direction: column;
        padding: 16px 20px;
    }
    .b2b-action-btn { width: 100%; }

    /* Adjust banner layout for narrow screens */
    .b2b-banner { flex-direction: column; align-items: flex-start; gap: 6px; }
    .b2b-banner-status, .b2b-banner-message { width: 100%; }
}

/* Extra narrow screens: maximize space, minimal padding */
@media (max-width: 640px) {
    /* Maximize modal to full width - override flexbox centering */
    .b2b-visualizer-overlay {
        padding: 0 !important;
        margin: 0 !important;
        display: block !important;
        overflow: hidden !important;
        align-items: unset !important;
        justify-content: unset !important;
    }

    .b2b-visualizer-modal {
        position: absolute !important;
        inset: 0 !important;
        width: auto !important;
        height: auto !important;
        max-width: none !important;
        min-width: 0 !important;
        max-height: none !important;
        min-height: 0 !important;
        border-radius: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
        border: none !important;
        box-shadow: none !important;
        box-sizing: border-box !important;
    }

    .b2b-visualizer-header {
        padding: 12px 10px;
    }

    .b2b-visualizer-title { font-size: 18px; }
    .b2b-visualizer-subtitle { font-size: 13px; margin-top: 2px; }

    .b2b-visualizer-body {
        padding: 12px 0;
        gap: 14px;
    }

    /* Remove horizontal padding from body at small sizes */
    .b2b-visualizer-body {
        padding-left: 0;
        padding-right: 0;
    }

    .b2b-chain-column, .b2b-option-column {
        gap: 10px;
        padding: 0 10px;
    }
    .b2b-chain-cards, .b2b-option-list { gap: 10px; }

    .b2b-chain-card, .b2b-option-card {
        padding: 12px;
        gap: 8px;
        border-radius: 10px;
    }

    .b2b-section-title { font-size: 14px; }
    .b2b-section-title small { font-size: 11px; }

    .b2b-actions {
        padding: 12px 10px;
    }

    .b2b-action-btn { padding: 11px 14px; font-size: 14px; }
}

/* Landscape mode with short height: optimize vertical space */
@media (orientation: landscape) and (max-height: 730px) {
    /* Maximize modal in landscape */
    .b2b-visualizer-overlay {
        padding: 12px;
    }

    .b2b-visualizer-modal {
        max-height: calc(100vh - 24px);
        min-height: calc(100vh - 24px);
    }

    .b2b-visualizer-header {
        padding: 8px 14px;
    }

    .b2b-visualizer-title { font-size: 17px; }
    .b2b-visualizer-subtitle { display: none; } /* Save vertical space */

    .b2b-visualizer-body {
        grid-template-columns: 300px 1fr;
        padding: 10px 14px;
        gap: 12px;
        max-height: none;
        flex: 1 1 auto;
        min-height: 0;
    }

    .b2b-chain-column {
        min-width: 280px;
        max-width: 320px;
        display: flex;
        flex-direction: column;
        min-height: 0;
    }

    .b2b-chain-cards {
        flex: 1 1 auto;
        min-height: 0;
        overflow-y: auto;
        overflow-x: hidden;
        gap: 8px;
    }

    .b2b-chain-card { flex: 0 0 auto; }

    /* Next Connections: single column in landscape mode */
    .b2b-option-list {
        grid-template-columns: 1fr;
        gap: 8px;
    }

    .b2b-chain-card, .b2b-option-card { padding: 10px; gap: 6px; }

    /* Compact banner */
    .b2b-banner {
        padding: 6px 10px;
        font-size: 11px;
        gap: 4px;
        flex-wrap: wrap;
    }

    /* Keep action buttons horizontal in landscape */
    .b2b-actions {
        flex-direction: row;
        gap: 8px;
        padding: 10px 14px;
    }

    .b2b-action-btn {
        flex: 1 1 auto;
        padding: 9px 12px;
        font-size: 13px;
        min-width: 110px;
    }
}

/* Modal footer responsive rules: ensure footer buttons align and reflow on narrow screens */
.table-footer-container {
    display: grid !important;
    grid-template-columns: 1fr auto 1fr;
    grid-template-areas: "left center right";
    align-items: center;
    column-gap: 12px;
    padding: 12px 20px;
    box-sizing: border-box;
}
#gobo-footer-left { grid-area: left; justify-self: start; display:flex; align-items:center; gap:8px; }
#gobo-footer-center { grid-area: center; justify-self: center; display:flex; align-items:center; }
#gobo-footer-right { grid-area: right; justify-self: end; display:flex; align-items:center; gap:8px; }

/* Make footer buttons and links consistent height and alignment */
.table-footer-container button,
.table-footer-container a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
}
.table-footer-container .export-csv-button,
.table-footer-container .close-button,
.table-footer-container .buy-coffee-link,
.table-footer-container .venmo-link,
.table-footer-container .whatsnew-btn {
    height: 36px;
    line-height: 1;
    padding: 0 10px !important; /* horizontal padding only */
    margin: 0 4px !important;
    /* Ensure footer buttons use the same font as the close button (inherit from container) */
    font-family: inherit !important;
    font-size: inherit !important;
    box-sizing: border-box;
}

/* Center footer contents and keep compact spacing */
.table-footer-container { display:flex !important; justify-content:center !important; gap:8px !important; }

@media (max-width: 420px) {
    /* Left group spans full width on the first row, center & right share the second row side-by-side */
    .table-footer-container {
        grid-template-columns: 1fr 1fr !important;
        grid-template-areas: "left left" "center right" !important;
        row-gap: 8px !important;
        padding: 10px 12px !important;
        width: 100% !important;
    }
    /* Make the left group stretch and distribute its children across the full width */
    #gobo-footer-left { justify-self: stretch !important; width:100% !important; display:flex !important; align-items:center !important; gap:8px !important; justify-content:space-evenly !important; }
    /* Ensure center/right occupy their grid cells and fill horizontally */
    #gobo-footer-center { justify-self: stretch !important; width:100% !important; display:flex !important; justify-content:flex-end !important; }
    #gobo-footer-right { justify-self: stretch !important; width:100% !important; display:flex !important; justify-content:flex-start !important; gap:8px !important; }
    /* Keep buttons consistent at small widths: explicit height + horizontal padding */
    .table-footer-container .close-button,
    .table-footer-container .export-csv-button,
    .table-footer-container .whatsnew-btn {
        height: 36px;
        padding: 0 12px !important;
        box-sizing: border-box;
    }
}

/* Compact footer for narrow+modern phones (covers iPhone 14 Pro Max width ~430px) */
@media (max-width: 480px) {
    .table-footer-container {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 8px !important;
        padding: 10px 12px !important;
        align-items: center !important;
        justify-content: space-between !important;
        width: 100% !important;
        padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px) !important;
    }
    /* Top row: icons only, evenly spaced */
    #gobo-footer-left { order: 1 !important; flex: 1 1 100% !important; display: flex !important; justify-content: space-evenly !important; align-items: center !important; }
    /* Second row: Export and Close as two half-width buttons */
    #gobo-footer-center { order: 2 !important; flex: 1 1 48% !important; display:flex !important; justify-content: flex-start !important; }
    #gobo-footer-right { order: 3 !important; flex: 1 1 48% !important; display:flex !important; justify-content: flex-end !important; }

    /* Make export and close consistent but do NOT force full width (prevents unwanted stacking) */
    /* Ensure export, close, whatsnew and donate share the same mobile sizing */
    .table-footer-container .export-csv-button,
    .table-footer-container .close-button,
    .table-footer-container .whatsnew-btn,
    .table-footer-container .donate-button {
        box-sizing: border-box !important;
        height: 40px !important;
        padding: 0 8px !important; /* reduced horizontal padding */
        max-width: 220px !important;
        font-size: 13px !important; /* slightly smaller font on narrow screens */
    }

     /* Hide non-essential text on the coffee link only when it's in the footer row to save space
         (but show full text when the link is inside the donate panel). */
     .table-footer-container .buy-coffee-link .buy-coffee-text { display: none !important; }
     .buy-coffee-link { padding: 6px 8px !important; }
     /* Ensure the donate panel always shows the full coffee text */
     .donate-panel .buy-coffee-text { display: inline-block !important; }

    /* Venmo: keep icon, slightly larger touch target */
    .venmo-link { width: 32px !important; height: 32px !important; }
    .venmo-link img { width: 100% !important; height: 100% !important; object-fit: contain !important; }

    /* Prevent footer items from stretching weirdly */
    .table-footer-container .buy-coffee-link, .table-footer-container .venmo-link, .table-footer-container { flex: 0 0 auto !important; }
}

/* Extra-tight rules for very narrow modals (<=420px) to reduce gaps and padding further */
@media (max-width: 420px) {
    .table-footer-container { gap: 6px !important; padding: 8px 10px !important; }
    #gobo-footer-left { gap:6px !important; }
    .table-footer-container .export-csv-button,
    .table-footer-container .close-button,
    .table-footer-container .whatsnew-btn,
    .table-footer-container .donate-button {
        padding: 0 6px !important; /* extra-tight horizontal padding */
        height: 36px !important;
        font-size: 12px !important; /* reduce font size slightly to avoid wrapping */
    }
    /* also reduce spacing for inline links in footer */
    .table-footer-container .buy-coffee-link, .table-footer-container .venmo-link { margin: 0 2px !important; }
}

@media (prefers-reduced-motion: reduce) {
    .b2b-pill-button,
    .b2b-option-select,
    .b2b-action-btn,
    .b2b-visualizer-close { transition:none !important; transform:none !important; }
}
/* Venmo circular button — match hover lift and subtle background change */
.venmo-link { transition: background .15s, transform .08s; will-change: transform; }
.venmo-link:hover { transform: translateY(-1px); background: rgba(0,0,0,0.04); }

/* Ensure coffee button also has will-change for smoother render */
.buy-coffee-link { will-change: transform; }

/* Respect users' motion preferences */
@media (prefers-reduced-motion: reduce) {
    .buy-coffee-link, .venmo-link, .b2b-search-button {
        transition: none !important;
        transform: none !important;
        will-change: auto !important;
    }

/* Ensure venmo image preserves aspect ratio and is not cropped */
.venmo-link img {
    width: 24px !important;
    height: 24px !important;
    object-fit: contain !important;
    display: block !important;
}

/* Ensure donate / footer buttons stay on single row by default; responsive rules will override when needed */
.table-footer-container { white-space: nowrap; }

}

/* Breadcrumbs */
.breadcrumb-container { display:flex; align-items:center; gap:8px; padding:8px; margin-bottom:8px; }
.breadcrumb-link { color:#2563eb; text-decoration:underline; cursor:pointer; }
.breadcrumb-link:hover { color:#1e40af; }
.breadcrumb-arrow { display:none; }
.accordion-view .breadcrumb-arrow { display:inline; }
.breadcrumb-arrow::after { content:'→'; margin:0 8px; }
/* Offer rows highlighting */
.newest-offer-row { background:#DFD !important; }
.expiring-soon-row { background:#FDD !important; }

/* Offer highlight legend (footer color key) */
.gobo-legend-box { display:inline-block; width:14px; height:14px; border:1px solid #ccc; margin-right:4px; vertical-align:middle; border-radius:3px; }
.gobo-legend-box-expiring { background:#FDD; }
.gobo-legend-box-newest { background:#DFD; }
.gobo-legend-label-newest { color:#14532d; }

body.gobo-dark .gobo-legend-box { border-color: rgba(148,163,184,0.6); }
body.gobo-dark .gobo-legend-box-expiring { background:#231015; }
body.gobo-dark .gobo-legend-box-newest { background:#064e3b; }
body.gobo-dark .gobo-legend-label-expiring { color:#e9c1c8; }
body.gobo-dark .gobo-legend-label-newest { color:#ecfdf5; }

body.gobo-dark .newest-offer-row {
    background:#064e3b !important;
    color:#ecfdf5;
}
body.gobo-dark .newest-offer-row a { color:inherit; }
body.gobo-dark .expiring-soon-row {
    background:#231015 !important;
    color:#e9c1c8;
}
body.gobo-dark .expiring-soon-row a { color:inherit; }

/* Group icon interactivity for headers (table + accordion) */
.group-icon { display:inline-flex; align-items:center; justify-content:center; width:20px; height:20px; border-radius:6px; cursor:pointer; opacity:0.95; transition:background .12s, transform .08s, box-shadow .12s; }
.group-icon svg { display:block; width:16px; height:16px; }
.group-icon:hover { background: rgba(2,6,23,0.06); transform: translateY(-1px); box-shadow: 0 6px 12px rgba(2,6,23,0.06); }
.group-icon:active { transform: translateY(0); box-shadow: none; }
.group-icon:focus-visible { outline: 2px solid rgba(59,130,246,0.9); outline-offset:2px; }

/* Slightly larger hit area on small screens */
@media (max-width:640px) {
    .group-icon { width:24px; height:24px; border-radius:8px; }
}
/* Updated: tier filter now inline inside breadcrumb */
.tier-filter-toggle { margin-left:auto; display:inline-flex; align-items:center; gap:6px; font-size:12px; background:rgba(255,255,255,0.9); padding:4px 8px; border:0; border-radius:6px; box-shadow:0 1px 2px rgba(0,0,0,0.08); font-weight:500; }
body.gobo-dark .tier-filter-toggle {
    background: rgba(15,23,42,0.8);
    border:0;
    color:#e2e8f0;
    box-shadow:0 1px 2px rgba(0,0,0,0.45);
}
body.gobo-dark #hidden-groups-display {
    background:#0b1220;
    border:1px solid rgba(148,163,184,0.25);
    color:#cbd5f5;
}

/* Search/settings controls: base styling */
.adv-search-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 6px 10px;
    font-size: 12px;
    border-radius: 8px;
    border: none;
    background: rgba(15,23,42,0.08);
    color: #0f172a;
    font-weight: 600;
    cursor: pointer;
}
body.gobo-dark .adv-search-button {
    background: rgba(148,163,184,0.2);
    color: #e2e8f0;
}

/* Streamline controls on narrow screens */
@media (max-width: 600px) {
    .breadcrumb-controls-row { justify-content: flex-start !important; }
    .tier-filter-toggle {
        width: 100%;
        flex-wrap: wrap;
        gap: 6px;
        padding: 6px 8px;
    }
    .adv-search-button {
        flex: 1 1 100%;
        justify-content: center;
    }
    .hidden-groups-label { margin-left: 0 !important; font-size: 11px; }
    #hidden-groups-display { flex: 1 1 100%; min-width: 0; }
    .gobo-settings-gear,
    .gobo-itinerary-refresh-inline {
        width: 32px;
        height: 32px;
        padding: 0;
        margin-left: 0 !important;
    }
}

@media (max-width: 420px) {
    .hidden-groups-label { display: none; }
}

/* Settings modal descriptions */
.gobo-setting-desc { color:#4b5563; }
body.gobo-dark .gobo-setting-desc { color:#cbd5f5; }
.b2b-visualizer-body.gobo-settings-body {
    display: flex;
    flex-direction: column;
    gap: 12px;
    grid-template-columns: 1fr !important;
    overflow-y: scroll;
    overflow-x: hidden;
    scrollbar-gutter: stable;
}

/* Settings modal: avoid oversized min-height on small screens (iOS) */
.b2b-visualizer-modal.gobo-settings-modal {
    min-height: auto;
    height: auto;
    max-height: calc(100vh - 32px);
}

/* Settings: Visible Columns grid */
.gobo-columns-grid { min-width:0; }
.gobo-columns-grid label { min-width:0; flex:0 1 200px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
/* Expanded breadcrumb layout variant */
.breadcrumb-container { display:flex; flex-direction:column; align-items:flex-start; gap:0; padding:8px; margin-bottom:8px; width:100%; }
.breadcrumb-tabs-row { width:100%; margin-bottom:0; }
.breadcrumb-crumb-row { display:flex; align-items:center; gap:8px; width:100%; padding-top:12px; background:transparent; }
/* Support link styling */
.support-link { display:inline-flex; align-items:center; gap:4px; font-size:10px; color:#2563eb; text-decoration:none; font-weight:600; line-height:1; }
.support-link:hover { text-decoration:underline; color:#1d4ed8; }
.support-link:focus { outline:1px solid #2563eb; outline-offset:2px; }
.support-link-icon { width:14px; height:14px; display:block; border-radius:3px; }
@media (prefers-reduced-motion: reduce) { .support-link { transition:none; } }

/* Chain link icons (both selected and unselected) visibility in dark mode */
body.gobo-dark .profile-link-icon-img {
    filter: brightness(1.8) contrast(1.2) saturate(1.1);
}
